---
title: NLU期末复习1-HMM隐马尔科夫模型（Hidden Markov Model）
mathjax: true
categories: 随便写写
tags:
  - NLP
  - 期末复习
  - 隐马尔科夫模型
abbrlink: c59edc3f
date: 2024-11-16 14:25:47
---
[隐马尔可夫模型](https://zh.wikipedia.org/wiki/%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B)参考链接见这里

## 赌场风云

你手下的赌场最近生意惨淡，因为有一个大叔在你的赌场几乎战无不胜总是能够赢到💵💰。根据你多年的赌场运营经验，这个大叔大概率是用自己的特质骰子来替换掉了均匀骰子来赢得比赛。但是这位大叔来者不善，不能正面冲突，正愁上心头的时候年迈的你回想起了你的大学教育和~~小学就学习过~~的隐马尔科夫模型(**HMM**).

<center>
<img src="https://memeprod.sgp1.digitaloceanspaces.com/user-wtf/1669971024831.jpg" width="60%">
</center>

LMM让你只需要记录上大叔每局投出的点数，你就可以根据这些数据推导出：

- 大叔是不是真的作弊
- 如果确实是在作弊，用了几个作弊骰子？当前有没有在作弊
- 这几个作弊骰子的结构（出现各个点数的概率

## 什么是隐马尔科夫模型

隐马尔可夫模型（英语：Hidden Markov Model；缩写：HMM），或称作隐性马尔可夫模型，是统计模型，用来描述一个含有隐含未知参数的马尔可夫过程。其难点是从可观察的参数中确定该过程的隐含参数。然后利用这些参数来作进一步的分析。**在隐马尔可夫模型中，状态并不是直接可见的，但受状态影响的某些变量则是可见的。**

就像下图所展示的，隐马尔科夫模型的定义：

设$X_n,Y_n$为离散~~其实连续也行~~时间随机过程，$n\geq1$，则$(X_n,Y_N)$为隐马尔科夫模型的条件是：

- $X_n$是马尔科夫过程，其行为无法直接观测
- $P(Y_n|X_1=x_1,\dots X_n=x_n)=P(Y_n|X_n=x_n)$，人话就是$Y$当前的状态只取决于$X$当前的状态

<center>
<img src="/pics/1731740274318.png" width="60%">
</center>

上图展示了HMM的状态迁移，由图中所展示的$X(t)$仅和$X(t-1)$有关，而$X(t-1)$又和$X(t-2)$有关。每个$Y(t)$仅仅由$X(t)$决定。

假设我们观察到的结果为$Y$

$$
Y=y(0),y(1)\dots ,y(L-1)
$$

观察不到的隐藏状态为$X$

$$
X=x(0),x(1)\dots,x(L-1)
$$

长度都是$L$，那么马尔科夫链的概率可以表述为

$$
X=\sum_{X}P(Y|X)P(X)
$$

## 用HMM来做什么？

HMM有三个典型的问题：

- 预测（filter）：已知模型一系列特定输出序列求最后一个时刻的隐状态概率分布，也就是求：

  $$
  P(x(t)|y(1),y(2)\dots ,y(t))
  $$
- 平滑处理（smoothing）：已知模型某一特定显状态输出序列，求中间某时刻隐状态的概率分布：

  $$
  P(x(k)|y(1),y(2)\dots ,y(t))\quad where\quad k\in (1,t)
  $$
- 解码（most likely explaination）：已知模型参数，寻找最可能的能产生某一特定输出序列的隐状态序列，即求：

  $$
  P([x(1)\dots x(t)]|[y(1)\dots y(t)])
  $$

## 破解赌场难题

在我们这个赌场问题的情形下，隐状态$X显然就是大叔手里的骰子到底是均匀的还是自己特制的，就像下图描述的：

<center>
<img src="/pics/1731744982720.png" width="60%">
</center>


这样一个状态转移关系我们可以使用状态迁移矩阵来表示：

$$

A=\left[
    \begin{matrix}
    0.15&0.45&0.4\\
    0.25&0.35&0.4\\
    0.10&0.55&0.35\\
    \end{matrix}
\right]
$$


对于不同的状态我们显状态（点数出现概率是可观察的）输出概率是不同的，如下图所示：

<center>
<img src="/pics/1731745423767.png" width="60%">
</center>